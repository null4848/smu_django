/*! @kyobobook/kbb-js v1.0.10 (build 20250618-103334) */
"use strict";!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.__KbbJS__=e():(t.__KbbJS__=t.__KbbJS__||{},t.__KbbJS__["plugins.ui-pop-collect-sentence"]=e())}(self,(function(){return(self.webpackChunk_KbbJS_=self.webpackChunk_KbbJS_||[]).push([[741],{97729:function(t,e,i){i.r(e),i.d(e,{default:function(){return N}});var s=i(35820),a=i.n(s),n=i(13792),o=i(82324),l=i(51956),c=i(48306);function r(){if(!this.urlinfo.debugPop("pop-collect"))return;const t=this.urlinfo.debug("collect")||"",e=this.urlinfo.debug("page")||"";[()=>{this.collect=t,this.page=e,this.active=!0}].forEach((t=>setTimeout(t,1e3)))}var p=i(96526);const d={add:"add",modify:"modify"},h={integ:"integrated",present:"present"},u="myroom",_="product",g="event",m="welcome",f="order",b="create-sentence-form-ga-script";function v(){const t=this.ua.isMobile,e=this.getOption("trigger");if(null===e)return;if(this._id=$(e).attr("data-target"),$(this._id).length)return this._dialog=$(this._id).dialog("instance"),$(this._id);const i=(0,p.ut)({id:$(e).attr("data-target").replace(/^#/,""),class:"dialog_wrap has_btn ".concat(this.type===h.integ?t?"":"no_title_line":t?"no_title_line":""),"data-class":t?"dialog_full":"dialog_sm"}),s=$('<button type="button" class="btn_dialog_close"><span class="ico_dialog_close"></span><span class="hidden">닫기</span></button>'),a=(0,p.ut)("dialog_header").append((0,p.ut)({class:"dialog_title",text:"문장수집 ".concat(this.event===d.add?"작성":"수정")})),n=y.call(this),o=$('<button type="button" class="btn_md btn_primary disabled"><span class="text">'.concat(this.event===d.add?"등록":"수정","</span></button>")),l=(0,p.ut)("dialog_footer").append(o);return i.append([s,a,n,l]),$("body").append(i),this.setElement("dialog",i),i}function y(){const t=this.ua.isMobile,e=(0,p.ut)("dialog_contents"),i=(0,p.ut)("custom_scroll_wrap");let s=null;const a=t?x.call(this):w.call(this),n=k.call(this),o=this.getOption("searchId")||"popProdSearchPop",l=(0,p.ut)("btn_wrap page_top ".concat(t?"":"full")).append((0,p.ut)({class:"btn_".concat(t?"sm":"ip"," btn_line_gray"),type:"button","data-target":"#".concat(o),"data-role":"btn-dialog"},"button").append(['<span class="ico_search"></span>','<span class="text">상품 검색</span>']).on("click",(t=>{this.productDialog.active=!0})));this.setElement("product.search",l);let c=[];return c=null!==this.product?[a,n,E.call(this)]:[n,E.call(this)],this.type===h.integ?(c.unshift(l),s=i.append((0,p.ut)("integrate_wrap").append(c))):s=i.append(c),e.append(s)}function E(){const t=this.ua.isMobile?"162":"70",e=null!==this.product?"책 속 마음을 두드리는 한 문장을 기록해보세요. 5자 이상 입력해주세요.":"상품을 먼저 선택하세요.",i=(0,p.ut)("form_wrap ".concat(this.isMobile?"type_md":"type_lg")),s=(0,p.ut)({id:"textKillingPart",class:"form_textarea",title:"타이틀 입력",placeholder:e,style:"height: ".concat(t,"px;")},"textarea");this.setElement("textArea",s);const a=[(0,p.ut)("form_box").append([(0,p.ut)("form_title").append((0,p.ut)({for:"textKillingPart",class:"form_label",html:'문장수집 작성 <span class="required"><span class="hidden">필수입력</span></span>'},"label")),(0,p.ut)("form_cont").append((0,p.ut)("byte_check_wrap").append([s,(0,p.ut)("byte_check_footer").append((0,p.ut)("byte_check").append([(0,p.ut)({class:"count",text:0},"span"),(0,p.ut)({class:"total",text:300},"span")]))]))]),(0,p.ut)("form_box").append([(0,p.ut)("form_title").append((0,p.ut)("form_title").append((0,p.ut)({for:"inputPageNumber",class:"form_label",text:"발췌 페이지"},"label"))),(0,p.ut)("form_cont").append((0,p.ut)("form_prefix_box").append([(0,p.ut)({class:"prefix_unit",text:"P."}),(0,p.ut)({type:"number",id:"inputPageNumber",class:"form_ip",placeholder:"숫자만 입력"},"input")]))])];return i.append(a)}function w(){const t=this.ui.createPdtImgWrap({pid:this.pid,bid:this.getOption("bid"),type:this.getOption("dvsnCode")}).attr("href",(0,p.kR)({pid:this.pid,type:this.getOption("dvsnCode")})),e=(0,p.ut)({class:"prod_name",text:this.title},"span");this.setElement("thumbnail",t),this.setElement("product.name",e);return(0,p.ut)("thumbnail_round_box").append((0,p.ut)("prod_area horizontal").append([(0,p.ut)("prod_thumb_box size_min").append(t),(0,p.ut)("prod_info_box size_xs").append((0,p.ut)({href:(0,p.kR)({pid:this.pid,type:this.getOption("dvsnCode")}),class:"prod_info"},"a").append(e))]))}function x(){const t=(0,p.LM)({pid:this.pid,bid:this.getOption("bid"),type:this.getOption("dvsnCode")}),e=(0,p.ut)({class:"img_box"},"span").append(t),i=(0,p.ut)({class:"prod_name",text:this.title});this.setElement("thumbnail",e),this.setElement("product.name",i);return(0,p.ut)("prod_round_box").append((0,p.ut)("prod_area horizontal").append([(0,p.ut)("prod_thumb_box size_min").append((0,p.ut)({href:(0,p.kR)({pid:this.pid,type:this.getOption("dvsnCode")}),class:"prod_link"},"a").append(e)),(0,p.ut)("prod_info_box size_sm").append((0,p.ut)({href:(0,p.kR)({pid:this.pid,type:this.getOption("dvsnCode")}),class:"prod_info"},"a").append(i))]))}function C(t){const{title:e,cmdtName:i,cmdtCode:s,id:a,saleCmdtid:n,dvsnCode:o,imgPath:l}=t,c=(0,p.ut)(this.isMobile?"prod_round_box":"thumbnail_round_box"),r=(0,p.ut)("prod_area horizontal"),d=(0,p.ut)("prod_thumb_box ".concat(this.isMobile?"size_xs":"size_min")).append(null!=l?(0,p.ut)("prod_link","a").append((0,p.ut)("img_box","span").append((0,p.ut)({src:l},"img"))).attr("href",(0,p.kR)({pid:a||n,type:o})):this.ui.createPdtImgWrap({pid:a||n,bid:s,type:o})).attr("href",(0,p.kR)({pid:a||n,type:o})),h=(0,p.ut)("prod_info_box size_xs").append((0,p.ut)({href:(0,p.kR)({pid:a||n,type:o}),class:"prod_info",html:'<span class="prod_name">'.concat(e||i,"</span>")},"a"));return r.append([d,h]),c.append(r),this.setElement("box",r),this.setElement("thumb",d),this.setElement("prucut.info",h),c}function k(){let t="";switch(this.getOption("dvsncode")){case c.Pp.KYOBO_BOOK_KOR:case c.Pp.KYOBO_BOOK_ENG:case c.Pp.KYOBO_PB:case c.Pp.COMBI_PRODUCT:case c.Pp.KYOBO_DGV:t=(0,p.ut)({class:"bul_item_dot ".concat(this.isMobile?"font_size_xs":"font_size_xxs"),text:"구매 후 작성 시, 90일 이내"},"p").append((0,p.ut)({class:"fc_black",text:" e 교환권 100원 적립"},"span"));break;case c.Pp.EBOOK:case c.Pp.EBOOK_AUDIO:case c.Pp.EBOOK_VIDEO:case c.Pp.EBOOK_DUM:case c.Pp.EBOOK_SAM:t=(0,p.ut)({class:"bul_item_dot ".concat(this.isMobile?"font_size_xs":"font_size_xxs"),text:"구매 후 90일 이내 작성 시,"},"p").append((0,p.ut)({class:"fc_black",text:" e교환권 100원 적립"},"span")).append((0,p.ut)({class:"".concat(this.isMobile?"font_size_xs":"font_size_xxs"),text:"(제외조건 유의사항 참조)"},"p"));break;default:return}const e=(0,p.ut)("info_text_box").append(t);return this.setElement("info",e),e}function S(){const t=v.call(this).one("dialogcreate",((t,e)=>{this._dialog=$(t.target).dialog("instance"),this.emit("init"),this.initialized=!0})).on("dialogclose",(t=>this.reset()));this.ui.dialog("#"+t.attr("id"))}var D=i(40196),O=i(99693),P=i(54569),M=i(91829),I=i.n(M);function A(){return document.querySelector("html").dataset.service}var R=i(73966);function L(){this.on(b,(t=>{window.dataLayer.push({ecommerce:null}),window.dataLayer.push({event:"item_event",event_name:"bookmark",ecommerce:{item_category:t.itemType||"",item_id:t.itemId||"",item_name:t.itemName||""}})}))}class T extends o.ht{constructor(t,e,i){var s,a;if(super(t,e,i),this._active=!1,this._collect="",this._page="",this._event=this.getOption("event")||d.add,this._type=this.getOption("type"),this._product=this.type===h.integ?null:{},this._pid=(null===(s=(0,l.getGlobalPluginOptions)("uiProduct"))||void 0===s?void 0:s.pid)||this.getOption("pid"),this._combiSaleCode=(null===(a=(0,l.getGlobalPluginOptions)("uiProduct"))||void 0===a?void 0:a.combiSaleCode)||this.getOption("pid"),this._title=this.getOption("title"),this._path=null,this._revwNum="",this._appRevw=new O.W,this.type===h.integ){var n,o;if($("#".concat(null==i||null===(n=i.elements)||void 0===n?void 0:n.searchId)).length>0)return;const t=(null==i||null===(o=i.elements)||void 0===o?void 0:o.searchId)||"popProdSearchPop";this._productDialog=new D.w(this,{id:t,type:"sentence"})}this.once("init",(()=>{this.init()})),this.on("product-insert",(t=>{let{data:e}=t;this.updateDom(e)})),L.call(this),S.call(this),r.call(this)}set product(t){this._product=t,this.emit("product-insert",{data:t})}get path(){return window.location.pathname}get product(){return this._product}get productDialog(){return this._productDialog}set active(t){t!==this.active&&null!=this.dialog&&this.dialog[t?"open":"close"]()}get active(){return this.dialog.isOpen()||!1}set getParentList(t){this.pid=t.id,this.product=t}get getParentList(){return this._getParentList}set collect(t){const e=t.length,i=this.getElement("submit"),s=this.getElement("textArea"),a=this.getElement("count");e>5&&null!=this.pid?i.removeClass("disabled"):i.addClass("disabled"),e>300?s.val(this.collect):(a.text(e),s.val(t),this._collect=t)}get collect(){return this._collect}set page(t){this.getElement("input").val(t),this._page=t}get page(){return this._page}set event(t){this._event=t}get event(){return this._event}set revwNum(t){this._revwNum=t}get revwNum(){return this._revwNum}set pid(t){const e=this.collect.length,i=this.getElement("submit");e>5&&null!=t?i.removeClass("disabled"):i.addClass("disabled"),this._pid=t}get pid(){return this._pid}set combiSaleCode(t){this._combiSaleCode=t}get combiSaleCode(){return this._combiSaleCode}get dialog(){return this._dialog}get $root(){return $(this.id)}get id(){return this._id}get type(){return this._type}get title(){return this._title}get appRevw(){return this._appRevw}get uiCollectSentence(){return this.uber.modules.get("uiCollectSentence")}get uiPopCollectSentence(){return this.uber.modules.get("uiPopCollectSentence")}init(){const t=this.$root,{elements:e}=this.options,i=t.find(null==e?void 0:e.submit);this.setElement("submit",i.on("click",(t=>{this.event!==d.add?this.submit():this.ui.alert({code:"AL_15_0020"}).then((t=>{let{value:e}=t;if(!e)return e;this.submit()}))})));const s=t.find(null==e?void 0:e.textArea);s.on("input paste",(t=>{this.collect=t.target.value})),this.setElement("textArea",s);const a=t.find(null==e?void 0:e.count);this.setElement("count",a);const n=t.find(null==e?void 0:e.input);n.on("propertychange change keyup paste input",(t=>{this.page=t.target.value})),this.setElement("input",n);t.find(null==e?void 0:e.close).on("click",(t=>{""===this.collect?this.active=!1:this.ui.alert({title:"작성한 내용은 저장되지 않습니다.<br/>취소하겠습니까?",showCancelButton:!0}).then((t=>{t.value&&(this.active=!1)}))}))}submit(){let t=R.T5.KYOBOBOOK;var e,i;this.pid&&(t=this.pid.startsWith("E")?R.T5.EBOOK:t,e=this.product.dvsncode,t=I()(i=[c.Pp.HOTTRACKS_DVD,c.Pp.HOTTRACKS_GIFT,c.Pp.HOTTRACKS_MUSIC_ALBUM]).call(i,e)?R.T5.HOTTRACKS:t);const s=this.buildParams(t),a="/api".concat((0,l.getGlobalOption)("api.urls.common.sentence.".concat(this.event)));this.ui.loading=!0,this.sendRequest(a,s).then(this.handleResponse.bind(this)).catch((t=>{P.u.call(this,t)})).finally((()=>{this.ui.loading=!1}))}showPopupAndAlert(t){this.ui.alert(t).then((()=>{this.appReviewPopUp()}))}buildParams(t){const e={kbcSiteCode:t,revwKindCode:"002",saleCmdtid:this.combiSaleCode||this.pid,revwCntt:this.collect,exttPageNum:""===this.page?0:parseInt(this.page)};return this.event===d.modify&&(e.revwNum=this.revwNum),e}sendRequest(t,e){return this.$http(t,{method:this.event===d.add?"POST":"PUT",body:e})}handleResponse(t){const{statusCode:e,detailMessage:i}=t;e===c.oj.OK&&(this.uiCollectSentence||this.uiPopCollectSentence)?this.handleSentenceSuccess(this):P.u.call(this,i),this.active=!1}handleSentenceSuccess(){const t="문장수집이 등록되었습니다.",e=A.call(this),i={page:1};this.type!==h.integ&&Object.assign(i,{saleCmdtid:this.combiSaleCode||this.pid}),e!==f&&this.uiCollectSentence.emit("get-data",{params:i});const s={[u]:()=>this.showPopupAndAlert(t),[_]:()=>{const e={};e.itemType=(0,n.U2)(this.options,"dvsncode"),e.itemId=this.combiSaleCode||this.pid,e.itemName=(0,n.U2)(this.options,"title"),this.emit(b,e),this.ui.alert(t)},[g]:()=>this.ui.alert(t),[m]:()=>this.ui.alert(t),[f]:()=>this.ui.alert(t)}[e];s&&s()}appReviewPopUp(){this.ui.loading=!0,this.$http("/api/gw/pdt/sentences/sentMonthCnt",{method:"GET"}).then((t=>{const{data:e}=t;if(this.authorized&&this.ua.isMobileApp&&e>=1){const t={cookieName:"my.sentences.appReviewAlert",iosUrl:"https://apps.apple.com/app/id464243977?action=write-review",androidUrl:"https://play.google.com/store/apps/details?id=mok.android",expiresNum:50,eventName:"문장수집"};this.appRevw.satisfactionConfirm(t)}else setTimeout(window.location.reload(),1e3)})).catch((t=>{const e=null==t?void 0:t.resultMessage;this.ui.alert(e||c.AQ.HTTP_ERROR),setTimeout(window.location.reload(),1e3)})).finally((()=>{this.ui.loading=!1}))}reset(){const t=this.getElement("count");if(t.length>0&&t.text("0"),this.page="",this.collect="",this.type===h.integ){(this.getElement("box")||[]).length>0&&(this.getElement("box").parent().remove(),this.getElement("product.search").find(".text").text("상품 검색"),this.getElement("textArea").attr("placeholder","상품을 먼저 선택하세요."))}}updateDom(t){const{title:e,cmdtName:i,imgPath:s,saleCmdtid:a,dvsnCode:n}=t;let o=this.getElement("dialog").find(".integrate_wrap .btn_wrap"),c=this.getElement("box")||[];return this.type===h.integ?(this.getElement("product.search").find(".text").text("상품 재검색"),this.getElement("textArea").attr("placeholder","책 속 마음을 두드리는 한 문장을 기록해보세요. 5자 이상 입력해주세요."),c.length?(c.parent().remove(),void o.after(C.call(this,t))):void o.after(C.call(this,t))):this.type===h.present||null==s?(o=this.getElement("dialog").find(".info_text_box"),c=this.getElement("dialog").find(this.isMobile?".prod_round_box":".thumbnail_round_box"),c.remove(),void o.before(C.call(this,t))):(this.getElement("thumbnail").closest("a").attr("href",(0,l.parseProdDetailURL)({pid:a,type:n})),this.getElement("thumbnail").closest("a").find(".img_box").removeClass("no_img"),this.getElement("thumbnail").find("img").attr("src",s),this.getElement("product.name").text(e||i),void this.getElement("product.name").closest("a.prod_info").attr("href",(0,l.parseProdDetailURL)({pid:a,type:n})))}loadScript(){this.$root.find('[data-kbbfn="ui-product-search"]').each(((t,e)=>{this.ui.loadKbbFn(e)}))}}class z extends o.YZ{constructor(){super("pop-collect-sentence"),this._list=[],this.initOptions()}initOptions(){Object.assign(this.options,{elements:{root:"#popKillingPartEdit",submit:".dialog_footer .btn_primary",textArea:"#textKillingPart",input:"#inputPageNumber",count:".byte_check_wrap .byte_check .count",close:".btn_dialog_close"}})}get list(){return this._list}createDialog(t){let e=(0,n.U2)(t,"trigger");if(null==e)return a().reject(new Error("[".concat(e,"] undefined trigger element selector!")));if((0,n.U2)(t,"type")===h.present&&$(e).on("click.update",(e=>{this.list[0].pid=(0,n.U2)(t,"pid"),this.list[0].product={cmdtName:(0,n.U2)(t,"title"),saleCmdtid:(0,n.U2)(t,"pid"),dvsnCode:(0,n.U2)(t,"dvsncode"),cmdtCode:(0,n.U2)(t,"bid")}})),!(0,l.isString)(e)){const t="trigger_"+this.list.length;$(e).data("kbbfn-sid",t),e=$(e).attr("data-target")}const i=this.getInstance(e);if(null!=i)return a().resolve(i);const s=new T(this,e,t);return this.list.push(s),a().resolve(s)}exists(t){return null!=this.getInstance(t)}getInstance(t){return this.list.find((e=>{let{id:i}=e;return i===t}))}}var N=new z},40196:function(t,e,i){i.d(e,{w:function(){return P}});var s=i(57170),a=i.n(s),n=i(82324),o=i(13792),l=i(96526),c=i(57508),r=i(62836),p=i(91829),d=i.n(p),h=i(51956);function u(t,e,i){const s=$(t.target).closest("tr").data("search-id"),a=i.find("img").attr("src"),n=i.find("img").data("kbbfn-adult"),o={title:e.CMDT_NAME,thumb:a,author:e.CHRC_ALL,pubName:e.PBCM_NAME,regDate:e.RLSE_DATE,klover:e.KLOVER_REVW_RVGR,cmdtCode:e.CMDTCODE,dvsnCode:e.SALE_CMDT_DVSN_CODE,id:s,$imgWrap:i,adultIf:n};this.uber.getParentList=o,this.active=!1}function _(t,e,i){const s=$(t.target).closest("li").data("search-id"),a=i.find("img").attr("src"),n=i.find("img").data("kbbfn-adult"),o={title:e.CMDT_NAME,thumb:a,author:e.CHRC_ALL,pubName:e.PBCM_NAME,regDate:e.RLSE_DATE,klover:e.KLOVER_REVW_RVGR,cmdtCode:e.CMDTCODE,dvsnCode:e.SALE_CMDT_DVSN_CODE,id:s,$imgWrap:i,adultIf:n};this.uber.getParentList=o,this.active=!1}function g(t){let e=[],i=[];var s;return d()(t).call(t,"|")?(e=t.split("|"),d()(s=e[0]).call(s,"@@")?(i=e[0].split("@@"),"".concat(i[1]," 외")):(i=e[0].split("@"),"".concat(i[2]," 외"))):d()(t).call(t,"@@")?(i=t.split("@@"),"".concat(i[1])):(i=t.split("@"),"".concat(i[2]||""))}const m=[{value:"KOR",text:"국내도서",selected:!0},{value:"FGN",text:"외국도서",exclude:[]},{value:"EBK",text:"eBook"},{value:"GFT",text:"핫트랙스",exclude:["sentence","review"]},{value:"MUSIC",text:"음반",exclude:["sentence","review"]},{value:"DVD",text:"DVD",exclude:["sentence","review"]}];function f(t){if(t){const t=(0,h.createEl)({id:this.id,class:"dialog_wrap spec_compare_search no_title_line","data-class":"dialog_full"}),e=(0,h.createEl)({type:"button",class:"btn_dialog_close","data-dialog-close":!0,html:'<span class="ico_dialog_close"></span><span class="hidden">닫기</span>'},"button"),i=(0,h.createEl)({class:"dialog_header",html:'<div class="dialog_title">상품 검색</div>'});return t.append([e,i])}{const t=(0,h.createEl)({id:this.id,class:"dialog_wrap spec_compare_search"}),e=(0,h.createEl)({type:"button",class:"btn_dialog_close","data-dialog-close":!0,html:'<span class="ico_dialog_close"></span><span class="hidden">닫기</span>'},"button").on("click",(t=>{this.active=!1})),i=(0,h.createEl)({class:"dialog_header",html:'<div class="dialog_title">상품 검색</div>'});return t.append([e,i])}}function b(t){const e=m.map((e=>{const i=(0,h.get)(e,"exclude",[]);if(d()(i).call(i,t))return;const{value:s,text:a}=e,n=(0,h.createEl)({value:s,text:a},"OPTION");return(0,h.get)(e,"selected")&&n.attr("selected","selected"),n})).filter(Boolean),i=(0,h.createEl)({id:"selectBook",title:"카테고리 선택"},"SELECT").append(e);return(0,h.createEl)("form_sel").append(i)}function v(t,e){if(t){return(0,h.createEl)("dialog_contents no_margin").append([(0,h.createEl)("contents_inner").append([(0,h.createEl)("form_search_box has_sel").append([b(e),(0,h.createEl)({class:"form_ip_search",html:'<input type="search" class="form_ip" placeholder="검색어를 입력하세요" title="타이틀" /><button type="button" class="btn_ip_clear"><span class="hidden">초기화</span></button>'}),(0,h.createEl)({type:"button",class:"btn_ip_search",html:'<span class="hidden">검색</span>'},"button")])]),(0,h.createEl)("switch_prod_wrap view_type_list").append([(0,h.createEl)("prod_list","ul")])])}return(0,h.createEl)("dialog_contents").append([(0,h.createEl)("custom_scroll_wrap").append([(0,h.createEl)("form_search_box has_sel").append([b(e),(0,h.createEl)({class:"form_ip_search",html:'<input type="search" class="form_ip" placeholder="상품을 검색해 보세요." title="타이틀" /><button type="button" class="btn_ip_clear"><span class="hidden">초기화</span></button>'}),(0,h.createEl)({type:"button",class:"btn_ip_search",html:'<span class="hidden">검색</span>'},"button")]),(0,h.createEl)("tbl_prod_wrap type_myroom").append([(0,h.createEl)("tbl_prod","table").append([(0,h.createEl)({text:"주문상품"},"caption"),(0,h.createEl)({},"colgroup").append([(0,h.createEl)({},"col"),(0,h.createEl)({style:"width: 75px"},"col")]),(0,h.createEl)({class:"hidden"},"thead").append([(0,h.createEl)({},"tr").append([(0,h.createEl)({scope:"col",text:"상품정보"},"th"),(0,h.createEl)({scope:"col"},"th")])]),(0,h.createEl)({class:"contentList"},"tbody")])]),(0,h.createEl)("pagination")])])}function y(t){return{pid:t.DQ_ID,bid:t.CMDTCODE,imgPath:t.IMAGE_URL,type:t.SALE_CMDT_DVSN_CODE,adult:t.PRHB_AGE}}function E(t){let e;const i=y(t);return"MUC"===t.SALE_CMDT_DVSN_CODE?e=(0,h.createProdImgAnchor)({...i,type:"MUC"}):"DVD"===t.SALE_CMDT_DVSN_CODE?e=(0,h.createProdImgAnchor)({...i,type:"DVD"}):"GFT"===t.SALE_CMDT_DVSN_CODE?e=(0,h.createProdImgAnchor)({...i,type:"GFT"}):(delete i.imgPath,e=this.modules.get("ui").createPdtImgWrap(i).attr("href",(0,h.parseStageURL)("/PDT/detail/".concat(t.DQ_ID)))),e}function w(t,e,i){const s=(0,h.parseProdDetailURL)(y(t));return(0,h.createEl)({"data-search-id":"".concat(t.DQ_ID)},"tr").append([(0,h.createEl)({class:"prod ".concat("ebook"===i?"type_bookcover size_sm":"")},"td").append([(0,h.createEl)("prod_area horizontal").append([(0,h.createEl)({class:"prod_thumb_box size_xs"}).append(E.call(this,t)),(0,h.createEl)({class:"prod_info_box size_xs",html:'<a href="'.concat(s,'" target="_blank" class="prod_info">')+'<span class="prod_name">'.concat(t.CMDT_NAME||"","</span>")+'<span class="prod_name">'.concat(g(null==t?void 0:t.CHRC_ALL),"·").concat(t.PBCM_NAME,"·").concat((0,h.getYMDformatByComma)(t.RLSE_DATE),"</span>")+"</a>"})])]),(0,h.createEl)({},"td").append([(0,h.createEl)({class:"btn_wrap full",html:'<button type="button" class="btn_xs btn_line_primary btn_select"><span class="ico_check"></span><span class="text">선택</span></button>'}).on("click",(e=>u.call(this,e,t,E.call(this,t))))])])}function x(t,e,i){const s=(0,h.parseProdDetailURL)(y(t));return(0,h.createEl)({class:"prod_item","data-search-id":"".concat(t.DQ_ID)},"li").append([(0,h.createEl)({class:"prod_area horizontal"}).append([(0,h.createEl)("prod_area horizontal").append([(0,h.createEl)({class:"prod_thumb_box"}).append(E.call(this,t)),(0,h.createEl)({class:"prod_info_box",html:'<a href="'.concat(s,'" target="_blank" class="prod_info">')+'<span class="prod_name">'.concat(t.CMDT_NAME,"</span>")+"</a>"+'<span class="prod_author">'.concat(g(null==t?void 0:t.CHRC_ALL),"·").concat(t.PBCM_NAME,"·").concat((0,h.getYMDformatByComma)(t.RLSE_DATE),"</span>")}).append([(0,h.createEl)("spec_control_wrap").append([(0,h.createEl)({type:"button",class:"btn_xxs btn_line_primary btn_select",html:'<span class="ico_check"></span><span class="text">선택</span>'},"button").on("click",(e=>_.call(this,e,t,E.call(this,t))))])])])])])}function C(t,e){const i=(0,h.numberWithCommas)(t),s=$('<p class="result_count">\''.concat(e,'\' 검색결과 <b class="fc_green">').concat(i,"</b>건</p>"));return this.setElement("result.title",s),(0,h.createEl)({class:"list_result_wrap",html:s}).append([(0,h.createEl)("right_area").append([(0,h.createEl)({class:"form_sel","data-class":"type_sm",style:"width: 140px;"}).append([(0,h.createEl)({title:"정렬 선택",id:"selectSort",html:'<option value="qntt" selected="selected">판매량순</option><option value="date">최신순</option><option value="name">상품명순</option>'},"SELECT")])])])}function k(t,e){const i=(0,h.numberWithCommas)(t),s=$('<p class="result_count">\''.concat(e,'\' 검색결과 <b class="fc_green">').concat(i,"</b>건</p>"));return this.setElement("result.title",s),[(0,h.createEl)({class:"list_result_wrap",html:s}).append([(0,h.createEl)("right_area").append([(0,h.createEl)({class:"form_sel","data-class":"type_sm",style:"width: 140px;",html:'<select id="selectSort" title="정렬 선택"><option value="qntt">판매량순</option><option value="date">최신순</option><option value="name">상품명순</option></select>'})])]),(0,h.createEl)("no_data has_desc_lg").append([(0,h.createEl)({class:"no_data_desc_lg",html:'<span class="fw_bold">'.concat(e,"</span>에 대한 검색 결과가 없습니다.")}),(0,h.createEl)({class:"no_data_desc",text:"검색어의 철자가 정확한지 다시 한 번 확인해주세요."})])]}function S(t,e){const i=(0,h.numberWithCommas)(t),s=$('<p class="result_count">\''.concat(e,'\' 검색결과 <b class="fc_green">').concat(i,"</b>건</p>")),a=(0,h.createEl)({title:"정렬 선택",id:"selectSort",html:'<option value="qntt" selected="selected">판매량순</option><option value="date">최신순</option><option value="name">상품명순</option>'},"select");return this.setElement("result.title",s),this.setElement("result.select",a),(0,h.createEl)({class:"list_result_wrap",html:s}).append([(0,h.createEl)("right_area").append([(0,h.createEl)({class:"form_sel type_no_line"}).append([a])])])}function D(t,e){return(0,h.createEl)("no_data size_lg has_desc_lg").append([(0,h.createEl)({class:"no_data_desc_lg",html:'<span class="fw_bold">'.concat(e,"</span>에 대한 검색 결과가 없습니다.")}),(0,h.createEl)({class:"no_data_desc",text:"검색어의 철자가 정확한지 다시 한 번 확인해주세요."})])}class O extends r.DialogComponent{constructor(t,e,i){super(),this._id=e,this._uber=t,((0,o.HD)(i)||(0,o.hj)(i))&&(i={text:""+i}),this._options=Object.assign({autoOpen:!1,el:f.call(this,i.isMobile)},i||{}),this.setOption("innerHtml",v.apply(this,[i.isMobile,i.type]))}get id(){return this._id}get uber(){return this._uber}create(){return super.create()}}class P extends n.Kp{constructor(t,e){super(t,e),this._options=e,this._id=(null==e?void 0:e.id)||"popProdSearch",this._dialog=new O(t,this._id,{isMobile:t.ua.isMobile,type:this.options.type}),this._type="",this._ra="qntt",this._pageSize=this.isMobile?10:20,this._pagingInfo="",this._page=1,this.on("list-change",(()=>{this.isMobile?this.getMokListData():this.getInkListData()})),this.init()}get keyword(){return this._keyword}set keyword(t){this._keyword=t}get pagingInfo(){return this._pagingInfo}set pagingInfo(t){this._pagingInfo=t}get getMokList(){return this._getMokList}get type(){return this._type}set type(t){this._type=t}get ra(){return this._ra}set ra(t){this._ra=t}get sort(){return this._sort}set sort(t){this._sort=t}get page(){return this._page}set page(t){this._page=t,this.emit("list-change")}get pageSize(){return this._pageSize}set pageSize(t){this._pageSize!==t&&(this._pageSize=parseInt(t),this.page>1?this.listComp.page=1:this.emit("list-change"),null!==this.pagi&&(this.pagi.pageSize=parseInt(t)))}get dialog(){return this._dialog}set active(t){this.dialog.active=t}get active(){return this.dialog.active}init(){this.dialog.create().then((()=>{$("#".concat(this.id)).on("dialogclose",(t=>{this.reset()})),this.domInit(this)}))}domInit(t){this.isMobile?(this.createMokListComp(t),$("#".concat(t._id,' input[type="search"]')).on("click",(e=>{$("#".concat(t._id," .form_ip")).removeAttr("placeholder")})),$("#".concat(t._id," .btn_ip_search")).on("click",(e=>{if(""!==$("#".concat(t._id," .form_ip")).val()){const e={type:$("#".concat(t._id," #selectBook")).val(),ra:this.ra,len:this._pageSize,keyword:$("#".concat(t._id," .form_ip")).val(),pagingInfo:"",page:this.page};this.type=$("#".concat(t._id," #selectBook")).val(),this.keyword=e.keyword,this.searchReset(),this.getMokListData(e,t)}else t.ui.alert({code:"AL_15_0006"})})),$("#".concat(t._id," .form_ip")).on("keyup",(e=>{if("Enter"===e.code)if(""!==$("#".concat(t._id," .form_ip")).val()){const e={type:$("#".concat(t._id," #selectBook")).val(),ra:this.ra,len:this._pageSize,keyword:$("#".concat(t._id," .form_ip")).val(),pagingInfo:"",page:this.page};this.type=$("#".concat(t._id," #selectBook")).val(),this.keyword=e.keyword,this.searchReset(),this.getMokListData(e,t)}else t.ui.alert({code:"AL_15_0006"})}))):($("#".concat(t._id," #selectBook")).selectmenu(),this.createInkListComp(t),$("#".concat(t._id)).find('input[type="search"]').on("click",(t=>{$(".form_ip").removeAttr("placeholder")})),$("#".concat(t._id)).find(".btn_ip_search").on("click",(e=>{if(""!==$("#".concat(t._id," .form_ip")).val()){const e={type:$("#".concat(t._id," #selectBook")).val(),ra:this.ra,len:this.pageSize,keyword:$("#".concat(t._id," .form_ip")).val(),pagingInfo:"",page:this._page};this.searchReset(),this.getData(e)}else t.ui.alert({code:"AL_15_0006"})})),$("#".concat(t._id," .form_ip")).on("keyup",(e=>{if(13===e.keyCode)if(""!==$("#".concat(t._id," .form_ip")).val()){const e={type:$("#".concat(t._id," #selectBook")).val(),ra:this.ra,len:this.pageSize,keyword:$("#".concat(t._id," .form_ip")).val(),pagingInfo:"",page:this._page};this.searchReset(),this.getData(e)}else t.ui.alert({code:"AL_15_0006"})})))}searchReset(){this.listComp.empty(),this._page=1,this.isMobile||$("#popProdSearch").find(".pagination").children().show()}getData(t){let e="/api/comSearch";return null!=t&&(e+="?"+new(a())(t).toString()),this.$http(e).then((e=>{const i=$("#".concat(this._id," .form_search_box.has_sel")),s=$("#popProdSearch .form_ip").val()?$("#popProdSearch .form_ip").val():(0,o.U2)(t,"keyword"),a=e.resultSet.result[0].totalSize;if(this.type=(0,o.U2)(t,"type"),this.pagingInfo=e.resultSet.result[0].brokerPagingInfo,this.keyword=t.keyword,this._pageSize=t.len,e.page=(0,o.U2)(t,"page",1),e.len=(0,o.U2)(t,"len"),e.type=(0,o.U2)(t,"type"),e.ra=(0,o.U2)(t,"ra"),e.keyword=(0,o.U2)(t,"keyword"),e.pagingInfo=(0,o.U2)(t,"pagingInfo"),a>0){if($("#".concat(this._id," .tbl_prod_wrap.type_myroom")).show(),$("#".concat(this._id," .no_data.has_desc_lg")).remove(),$("#".concat(this._id," .list_result_wrap")).length>0){const t=(0,l.x6)(a);this.getElement("result.title").html("'".concat(s,'\' 검색결과 <b class="fc_green">').concat(t,"</b>건"))}else i.after(C.call(this,a,s));this.ra=$("#selectSort").val(),t.ra=this.ra,this.listComp.data=e}else if($("#".concat(this._id," .tbl_prod_wrap.type_myroom")).hide(),$("#".concat(this._id," .list_result_wrap")).remove(),$("#".concat(this._id," .no_data.has_desc_lg")).remove(),this.listComp.empty(),$("#".concat(this._id," .list_result_wrap")).length>0){const t=(0,l.x6)(a);this.getElement("result.title").html("'".concat(s,'\' 검색결과 <b class="fc_green">').concat(t,"</b>건"))}else i.after(k.call(this,a,s));return $("#selectSort").selectmenu({change:t=>{const e={keyword:this.keyword,ra:t.target.value,type:this.type,page:1,len:this._pageSize,pagingInfo:this.pagingInfo};this.ra=e.ra,this.getData(e)}}),e}))}getMokData(t,e){let i="/api/comSearch";return null!=t&&(i+="?"+new(a())(t).toString()),this.$http(i).then((i=>{const s=$("#".concat(this._id," .contents_inner")),a=$("#popProdSearch .form_ip").val()?$("#popProdSearch .form_ip").val():(0,o.U2)(t,"keyword"),n=i.resultSet.result[0].totalSize;if(this.type=(0,o.U2)(t,"type"),this.pagingInfo=i.resultSet.result[0].brokerPagingInfo,this.keyword=t.keyword,this._pageSize=t.len,i.page=(0,o.U2)(t,"page",1),i.type=(0,o.U2)(t,"type"),i.keyword=(0,o.U2)(t,"keyword"),i.pagingInfo=(0,o.U2)(t,"pagingInfo"),n>0){if($("#".concat(this._id," .view_type_list")).show(),$("#".concat(this._id," .no_data.has_desc_lg")).remove(),$("#".concat(this._id," .list_result_wrap")).length>0){const t=(0,l.x6)(n);this.getElement("result.title").html("'".concat(a,'\' 검색결과 <b class="fc_green">').concat(t,"</b>건"))}else s.after(S.call(this,n,a));this.ra=t.ra,i.ra=(0,o.U2)(t,"ra")}else $("#".concat(this._id," .view_type_list")).hide(),$("#".concat(this._id," .list_result_wrap")).remove(),$("#".concat(this._id," .no_data.size_lg.has_desc_lg")).remove(),s.after(D.call(this,n,a));return this.getElement("result.select").off("change").on("change",(t=>{const i={ra:t.target.value,type:this.type,keyword:this.keyword,page:this.page,len:this._pageSize,pagingInfo:this.pagingInfo};this.searchReset(),this.ra=i.ra,this.getMokListData(i,e)})),i}))}createInkListComp(t){this.listComp=new c.n({el:$("#".concat(t._id," .contentList")),render:{data:t=>t.resultSet.result[0].resultDocuments,item:(e,i)=>w.call(t,e,i,this.type)},pagination:{el:$("#".concat(t._id," .pagination")),ready:()=>{this.listComp.pagi.on("change",(t=>{this.page=t.value}))},mapUpdateData:t=>({total:t.resultSet.result[0].totalSize,page:this.page,size:this.pageSize})}})}createMokListComp(t){this.listComp=new c.n({el:$("#".concat(t._id," .view_type_list .prod_list")),render:{data:t=>t.resultSet.result[0].resultDocuments,item:(e,i)=>x.call(t,e,i,this.type)},pagination:{el:$("#".concat(t._id," .switch_prod_wrap .pagination")),events:{pagi_ready:e=>{e.options.el=$("#".concat(t.id," .pagination"))},change:t=>{this.page=t.value}},mapUpdateData:t=>({total:t.resultSet.result[0].totalSize,page:t.page,size:this._pageSize})},infiniteScroll:this.isMobile})}getInkListData(){const t={page:this._page,len:this._pageSize,type:this.type,ra:this.ra,keyword:this.keyword,pagingInfo:this.pagingInfo};this.getData(t).then((t=>{this.listComp.data=t}))}getMokListData(t,e){var i;const s={page:this._page,len:this._pageSize,type:this.type,ra:this.ra,keyword:this.keyword,pagingInfo:this.pagingInfo};null===(i=this.getMokData(s,e))||void 0===i||i.then((t=>{1===this.listComp.page&&this.listComp.empty(),this.listComp.append(t)}))}reset(){this.selectBook="",this.selectSort="",$("#".concat(this._id," .form_ip")).val(""),$("#".concat(this._id," .dialog_contents .list_result_wrap")).remove(),this.listComp.empty()}}},54569:function(t,e,i){i.d(e,{e:function(){return o},u:function(){return n}});var s=i(13792),a=i(48306);function n(t){if((0,s.e$)(t,"code")){const e=(0,s.e$)(t,"code")?t:t.message||t;return this.ui.alert(e)}if((e=t)&&e.stack&&e.message){const e=(0,s.e$)(t,"code")?t:t.message||t;return this.ui.alert(e)}var e;let i=t.detailMessage;if(!i){const e=t.indexOf("{"),s=t.lastIndexOf("}"),a=t.substring(e,s+1);i=JSON.parse(a).detailMessage}return this.ui.alert(i||a.AQ.HTTP_ERROR)}function o(){return document.querySelector("html").dataset.service}},99693:function(t,e,i){i.d(e,{W:function(){return o}});var s=i(51956),a=i(96526),n=i(54174);class o extends s.UiPluginsModule{constructor(){super("app-revw",{initList:[s.InitPartial.AUTHORIZE]})}satisfactionConfirm(t){if(this.authorized&&this.ua.isMobileApp){null===(0,n.e)(t.cookieName)&&this.ui.alert({title:"오늘 교보문고 이용은 어떠신가요?\n마음에 드셨으면 좋겠어요 😊\n이용 후기를 알려주세요",showCancelButton:!0,cancelButtonText:"그냥 그래요",confirmButtonText:"좋아요!"}).then((e=>{if((0,n.d)(t.cookieName,e.value.toString(),{expires:t.expiresNum}),e.value){const e=t.iosUrl,i=t.androidUrl;l("좋아요_"+t.eventName,"",t.eventName),window.location.href=this.ua.isAndroid?i:e}else l("그냥 그래요_"+t.eventName,"",t.eventName),this.customerServiceConfirm(t)}))}}customerServiceConfirm(t){this.ui.alert({title:"죄송합니다\n아쉬웠던 점을 알려주세요\n더 나은 서비스를 위해 노력하겠습니다",showCancelButton:!0,cancelButtonText:"괜찮아요",confirmButtonText:"1:1문의 남기기"}).then((e=>{e.value?(l("","1:1문의남기기",t.eventName),window.location.href=(0,a.$u)("/ONK/cscenter/qna-form")):l("","괜찮아요",t.eventName)}))}appReviewAlert(t){const e=t.iosUrl,i=t.androidUrl;this.ui.alert({title:"감사합니다! 😊\n그렇다면 칭찬 리뷰를 남겨주세요\n큰 힘이 될거에요!",showCancelButton:!0,cancelButtonText:"다음에요",confirmButtonText:"네,좋아요!"}).then((s=>{s.value?(l("","네, 좋아요",t.eventName),window.location.href=this.ua.isAndroid?i:e):l("","다음에요",t.eventName)}))}}function l(t,e,i){""!==i&&null!==i&&window.ga360.GA_Event("click_"+i+"_MO",t,e,"","")}}},function(t){return t.O(0,[321,160,712],(function(){return e=97729,t(t.s=e);var e})),t.O()}])}));