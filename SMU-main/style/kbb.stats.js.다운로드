(function(P){typeof define=="function"&&define.amd?define(P):P()})(function(){"use strict";var P=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)},p=(e,t,n)=>(P(e,t,"read from private field"),n?n.call(e):t.get(e)),v=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},_=(e,t,n,r)=>(P(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),be=(e,t,n)=>(P(e,t,"access private method"),n);function ye(e){if(typeof e!="object"||e===null||Object.prototype.toString.call(e)!=="[object Object]")return!1;const t=Object.getPrototypeOf(e);if(t===null)return!0;const n=Object.prototype.hasOwnProperty.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&Function.prototype.call(n)===Function.prototype.call(e)}function R(e){return Array.isArray(e)?e:[e]}const ze=e=>{const t=e==null?void 0:e.match(/[A-Z]{2,}(?=[A-Z][a-z]+[0-9]*|\b)|[A-Z]?[a-z]+[0-9]*|[A-Z]|[0-9]+/g);return e==null||t==null?e:t.map(n=>n.toLowerCase()).join("_")},se=e=>e!=null&&typeof e.valueOf()=="string",g=(e,t,n)=>{const r=s=>String.prototype.split.call(t,s).filter(Boolean).reduce((i,a)=>i!=null?i[a]:i,e),o=r(/[,[\]]+?/)||r(/[,[\].]+?/);return o===void 0||o===e?n:o},A=(e,t,n)=>{const r=Array.isArray(t)?t:t.match(/([^[.\]])+/g);if(!r)return e;let o=e;for(let s=0;s<r.length;s++){const i=r[s];if(o[i]==null){const a=isNaN(Number(r[s+1]));o[i]=a?{}:[]}s===r.length-1&&(o[i]=n),o=o[i]}return e},Ze=function(e,...t){for(const n of t){const r=g(e,n);if(r!=null)return r}};function Oe(e=window.location.hostname){let t=["127.0.0.1","0.0.0.0","localhost"].includes(e);return t||(t=/^local\./.test(e)),t}function Je(e=window.location.hostname){return Oe()||/^[\w]+\.(dev3|ndev)\.kyobobook/.test(e)}function Qe(e){switch(e){case"true":return!0;case"false":return!1}return e}class Xe{constructor(){const t=window.location.href;var n;this.data=new URL(t),this.fullpath=(n=t)!=null&&n.length?(n.includes("?")?n=n.replace(/\?.*/,""):n.includes("#")&&(n=n.replace(/#.*/,"")),n.replace(/\/$/,"")):n??null,this.params=function(r){const{hostname:o,search:s}=r,i=r.searchParams??new URLSearchParams(s),a={};for(const[l,d]of i.entries()){let b=d;b=l==="debug"||Qe(d),a[l]=b}return Object.assign({isLocalHost:Oe(o),isDevHost:Je(o)},a)}(this.data),this.shortname=[this.hostname,this.pathname].join("/").replace(/[:/.]+/g,"")}get pathname(){return this.data.pathname}get hostname(){return this.data.hostname}get hash(){return window.location.hash}get isLocalhost(){return this.params.isLocalHost}get isDevHost(){return this.params.isDevHost}get debugMode(){return this.get("debug",!1)}get(t,n=void 0){return this.params[t]??n}has(t){return this.get(t)!=null}hasAll(t){return!!ye(t)&&Object.keys(t).map(n=>this.has(n)).every(Boolean)}debug(t,n=void 0){if(this.isDevHost&&this.debugMode)return this.get(t,n)}hasDebugLog(t){const n=this.debug("log");if(n==null||!n.length)return!1;const r=n.split(",").map(o=>o.trim());return R(t).every(o=>r.includes(o))}debugPop(t){return this.debug("pop")===t}getHashParams(t,n=void 0){if(!this.hash.length)return n;const r=this.hash.substring(1);if(!/^\?/.test(r)||r.length<2)return n;const o=function(s){const i=new URLSearchParams(s).entries(),a={};for(const[l,d]of i)a[l]=d;return a}(r);return t==null?o:o[t]??n}setHashParams(t){const n=Object.assign(this.getHashParams()||{},t);Object.keys(n).forEach(o=>{const s=n[o];s==null&&s!==""||delete s[o]});const r=new URLSearchParams(n).toString();window.location.hash="?"+r}}let ae=null;const et=()=>(ae==null&&(ae=new Xe),ae);function m(...e){et().debugMode&&console.info(...e)}var Ee,$,w=(($=w||{}).PBOOK="book",$.EBOOK="ebook",$.HOTTRACKS="hottracks",$),S=(e=>(e.INITIALIZED="initialized",e))(S||{}),le=(e=>(e.NORMAL="001",e.NO_SALE="002",e.NOT_PUBLISHED="004",e.CANT_BE_HANDLE="005",e.RESERVATION="008",e.NO_ONLINE="010",e.SOLD_OUT="014",e))(le||{}),f=(e=>(e.INK="ink",e.MOK="mok",e))(f||{}),ce={exports:{}},k=typeof Reflect=="object"?Reflect:null,Ie=k&&typeof k.apply=="function"?k.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};Ee=k&&typeof k.ownKeys=="function"?k.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var Ce=Number.isNaN||function(e){return e!=e};function u(){u.init.call(this)}ce.exports=u,ce.exports.once=function(e,t){return new Promise(function(n,r){function o(l){e.removeListener(t,s),r(l)}function s(){typeof e.removeListener=="function"&&e.removeListener("error",o),n([].slice.call(arguments))}var i,a;Ne(e,t,s,{once:!0}),t!=="error"&&(a=o,typeof(i=e).on=="function"&&Ne(i,"error",a,{once:!0}))})},u.EventEmitter=u,u.prototype._events=void 0,u.prototype._eventsCount=0,u.prototype._maxListeners=void 0;var Ae=10;function H(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function Te(e){return e._maxListeners===void 0?u.defaultMaxListeners:e._maxListeners}function Le(e,t,n,r){var o,s,i,a;if(H(n),(s=e._events)===void 0?(s=e._events=Object.create(null),e._eventsCount=0):(s.newListener!==void 0&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),i=s[t]),i===void 0)i=s[t]=n,++e._eventsCount;else if(typeof i=="function"?i=s[t]=r?[n,i]:[i,n]:r?i.unshift(n):i.push(n),(o=Te(e))>0&&i.length>o&&!i.warned){i.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+i.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=i.length,a=l,console&&console.warn&&console.warn(a)}return e}function tt(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Pe(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},o=tt.bind(r);return o.listener=n,r.wrapFn=o,o}function Re(e,t,n){var r=e._events;if(r===void 0)return[];var o=r[t];return o===void 0?[]:typeof o=="function"?n?[o.listener||o]:[o]:n?function(s){for(var i=new Array(s.length),a=0;a<i.length;++a)i[a]=s[a].listener||s[a];return i}(o):ke(o,o.length)}function Se(e){var t=this._events;if(t!==void 0){var n=t[e];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}function ke(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function Ne(e,t,n,r){if(typeof e.on=="function")r.once?e.once(t,n):e.on(t,n);else{if(typeof e.addEventListener!="function")throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,function o(s){r.once&&e.removeEventListener(t,o),n(s)})}}Object.defineProperty(u,"defaultMaxListeners",{enumerable:!0,get:function(){return Ae},set:function(e){if(typeof e!="number"||e<0||Ce(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");Ae=e}}),u.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},u.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Ce(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},u.prototype.getMaxListeners=function(){return Te(this)},u.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r=e==="error",o=this._events;if(o!==void 0)r=r&&o.error===void 0;else if(!r)return!1;if(r){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var i=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw i.context=s,i}var a=o[e];if(a===void 0)return!1;if(typeof a=="function")Ie(a,this,t);else{var l=a.length,d=ke(a,l);for(n=0;n<l;++n)Ie(d[n],this,t)}return!0},u.prototype.addListener=function(e,t){return Le(this,e,t,!1)},u.prototype.on=u.prototype.addListener,u.prototype.prependListener=function(e,t){return Le(this,e,t,!0)},u.prototype.once=function(e,t){return H(t),this.on(e,Pe(this,e,t)),this},u.prototype.prependOnceListener=function(e,t){return H(t),this.prependListener(e,Pe(this,e,t)),this},u.prototype.removeListener=function(e,t){var n,r,o,s,i;if(H(t),(r=this._events)===void 0)return this;if((n=r[e])===void 0)return this;if(n===t||n.listener===t)--this._eventsCount==0?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(o=-1,s=n.length-1;s>=0;s--)if(n[s]===t||n[s].listener===t){i=n[s].listener,o=s;break}if(o<0)return this;o===0?n.shift():function(a,l){for(;l+1<a.length;l++)a[l]=a[l+1];a.pop()}(n,o),n.length===1&&(r[e]=n[0]),r.removeListener!==void 0&&this.emit("removeListener",e,i||t)}return this},u.prototype.off=u.prototype.removeListener,u.prototype.removeAllListeners=function(e){var t,n,r;if((n=this._events)===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var o,s=Object.keys(n);for(r=0;r<s.length;++r)(o=s[r])!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(t=n[e])=="function")this.removeListener(e,t);else if(t!==void 0)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},u.prototype.listeners=function(e){return Re(this,e,!0)},u.prototype.rawListeners=function(e){return Re(this,e,!1)},u.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):Se.call(e,t)},u.prototype.listenerCount=Se,u.prototype.eventNames=function(){return this._eventsCount>0?Ee(this._events):[]};var q,ue,Y,W,V,nt=ce.exports;class rt extends nt.EventEmitter{constructor(){super(...arguments),v(this,q)}emit(t,...n){const r=Object.assign({target:this},...n,{type:t});return super.emit(t,r)}bind(t,n){return be(this,q,ue).call(this,t,n,"on")}bindOnce(t,n){return be(this,q,ue).call(this,t,n,"once")}}q=new WeakSet,ue=function(e,t,n="on"){return se(e)&&e.indexOf(" ")>0&&(e=e.split(" ")),R(e).forEach(r=>{this[n](r,t)}),this};class De extends rt{constructor(t={}){super(),v(this,Y,!1),v(this,W,{}),t!=null&&_(this,W,t),this.once(S.INITIALIZED,()=>{_(this,Y,!0)})}get initialized(){return p(this,Y)}get options(){return p(this,W)}setOption(t,n){A(this.options,t,n)}getOption(t,n){return g(this.options,t,n)}}Y=new WeakMap,W=new WeakMap;class ot extends De{constructor(t=void 0){super(t),v(this,V,[])}get list(){return p(this,V)}get length(){return p(this,V).length}}V=new WeakMap;var Ue,it=((Ue=it||{}).INITIALIZED="kbbstats-initialized",Ue),O=(e=>(e.KAKAO="kakao",e.NAVER="naver",e.FACEBOOK="facebook",e.MOBON="mobon",e.CUBOT="cubot",e.GOOGLE="google",e))(O||{});const st=Object.keys(O).map(e=>O[e]);var N=(e=>(e.PAGE_VIEW="pageView",e.CART="cart",e.ORDER="order",e.WISH="wish",e.SEARCH="search",e.INIT="init",e.SET_DATA="setData",e.GET_DATA="getData",e))(N||{});const at=Object.keys(N).map(e=>N[e]);var j=(e=>(e.CSS="css",e.JS="js",e))(j||{}),de=(e=>(e.LINK="link",e.SCRIPT="script",e))(de||{});const je=function(){return window.KbbJS};let D;const he=function(){if(D!==void 0)return D;const e=je();if(e!=null)return D=e.isMobile(),D;const t=document.querySelector("html[data-view]");return t!=null?(D=t.dataset.view==="mok",D):!!/^mhottracks\./.test(window.location.hostname)},M=function(){return he()?f.MOK:f.INK};function Me(){return window.dataLayer!=null||(window.dataLayer=[]),window.dataLayer}const lt=new class{get dataLayer(){return Me()}push(e){return function(t){var n;const r=Me();t.ecommerce!=null&&((n=r.at(-1))==null?void 0:n.ecommerce)!==null&&r.push({ecommerce:null}),r.push(t)}(e),this}},xe={"^(local\\.)?product\\.":w.PBOOK,"^ebook-product\\.":w.EBOOK,"^m?hottracks\\.":w.HOTTRACKS},Be=(e=window.location.host)=>{if(e.includes("kyobobook.co.kr")){for(const t in xe)if(new RegExp(t).test(e))return xe[t]}console.warn("매칭되는 교보문고 서비스몰을 찾을 수 없습니다.",e)},Ke="4ffe4f3c-7219-4bd2-a7ae-eba4aefc9b19",ct=function(e){return{exec(t,n,r){var o;((o=this.globals)==null?void 0:o.global).op(t,n,r)},set(t,n){this.exec("setVar",t,n)},setCUID(t=e){this.set("cuid",t)},setUserID(){const t=function(){const n=je();return n==null?"":n.user.get("sub")}();this.set("userId",t)},track(t,n){this.setCUID(n),this.setUserID(),this.exec("track",t)},cart(t,n){this.set("itemId",t),this.track("add_to_cart",n)},wish(t,n){this.set("itemId",t),this.track("zzim",n)},search(t,n){this.set("searchTerm",t),this.track("search",n)}}}(Ke),ut={name:[O.CUBOT,"qbot"],url:"https://logger.eigene.io/js/logger.min.js",globals:"eglc",props:{API_KEY:Ke,protoAlias:[{name:"cart",alias:["cartItem"]},{name:"wish",alias:["wishItem"]}]},prototype:ct},pe="fbq",dt={name:[O.FACEBOOK,"meta"],url:"https://connect.facebook.net/en_US/fbevents.js",globals:pe,props:{API_KEY:"247842611347428"},prehandle:function(){if(g(window,pe)!=null)return;const e=function(){e.callMethod?e.callMethod.apply(e,arguments):e.queue.push(arguments)};A(window,pe,e),g(window,"_fbq")==null&&A(window,"_fbq",e),e.push=e,e.loaded=!0,e.version="2.0",e.queue=[]},posthandle({global:e}){var t;e("init",(t=this.props)==null?void 0:t.API_KEY),e("track","PageView")}},Ge=e=>ye(e)?e.id:e,F="kakaoPixel",$e="1830363100807970928",ht={name:[O.KAKAO,F,F.toLowerCase()],url:"https://t1.daumcdn.net/kas/static/kp.js",globals:F,props:{API_KEY:$e},prototype:function(e){return{exec(t=e,...n){var r;return((r=this.globals)==null?void 0:r.global)(t,...n)},pageView(){return this.exec().pageView()},cart(t){const n=Ge(t);return this.exec().addToCart({id:n})},wish(t){const n=Ge(t);return this.exec().addToWishList({id:n})},search(t){return this.exec().search({keyword:t})}}}($e),posthandle:function(){const e=(t,...n)=>this.exec(t,...n);A(window,F,e),e().pageView()}},pt=[{slt:['[data-kbbfn="wish-item"]','[data-kbbfn="wish-item-list"]'].join(","),cls:"mobonWish"},{slt:'[data-kbbfn="cart-item"]',cls:"mobonCart"}],ft=()=>{pt.forEach(({slt:e,cls:t})=>document.querySelectorAll(e).forEach(n=>n.classList.add(t)))},E="ENP_VAR";var c=(e=>(e.PRODUCT_CODE="productCode",e.PRODUCT_NAME="productName",e.PRICE="price",e.QUANTITY="qty",e.DC_PRICE="dcPrice",e.SOLDOUT="soldOut",e.IMAGEURL="imageUrl",e.SECOND_IMAGEURL="secondImageUrl",e.THIRD_IMAGEURL="thirdImageUrl",e.FOURTH_IMAGEURL="fourthImageUrl",e.TOP_CATEGORY="topCategory",e.FIRST_SUB_CATEGORY="firstSubCategory",e.SECOND_SUB_CATEGORY="secondSubCategory",e.THIRD_SUB_CATEGORY="thirdSubCategory",e))(c||{});function He(e,t){return function(n){const r=R(n.raw??[]);return(o=n,((s=o.ecommerce)==null?void 0:s.items)??[]).map((i,a)=>{const l=r[a]??{};return Object.assign({},i,l)});var o,s}(t).map(n=>{const r={};return e.forEach(o=>{const s=function(i,a){const l=Ze.bind(null,i);switch(a){case c.PRODUCT_CODE:return l("item_id","saleCmdtid","cmdtCode","cmdtcode","id","combiSaleCode","combCmdtSaleCmdtid");case c.PRODUCT_NAME:return l("item_name","productName","cmdtName","title","combCmdtName");case c.PRICE:return l("price","salePrice","sapr","priceInfo.discountPrice","priceInfo.price","saleCmdtSapr");case c.DC_PRICE:return l("saleCmdtPrce");case c.QUANTITY:return l("quantity");case c.SOLDOUT:{const d=i.saleCdtnCode;if(d==null)return"N";switch(d){case le.NORMAL:case le.RESERVATION:return"N"}return"Y"}case c.TOP_CATEGORY:return i.item_category;case c.FIRST_SUB_CATEGORY:return i.item_category2;case c.SECOND_SUB_CATEGORY:return i.item_category3;case c.THIRD_SUB_CATEGORY:return i.item_category4}}(n,o);r[o]=s??""}),r})}Object.values(c);var qe=(e=>(e.WISH="wish",e.CART="cart",e))(qe||{});const{WISH:Ye,CART:We}=qe,z=".prod_detail_footer .footer_contents_inner",mt={[Ye]:[`${z} BUTTON.btn_wish`,".product_info_area .prod_share_area BUTTON.btn_ht_wish",".prod_purchase_info_wrap BUTTON.btn_wish"],[We]:[`${z} #basket`,`${z} BUTTON.cart`,`${z} BUTTON[data-target="#popBuyCart"]`,".prod_under_info #addCartBtn",".prod_purchase_info_wrap #onClickAddCart"]},vt=[".header_contents_inner"],gt={[f.INK]:".prod_detail_view_area .prod_thumb.e_book IMG",[f.MOK]:".prod_thumb_list LI IMG"},wt={[f.INK]:".prod_detail_head .prod_view_img .swiper-slide IMG",[f.MOK]:".prod_detail_header .visual_wrap .swiper-slide IMG"},_t=[".header_contents_inner"],bt={[f.INK]:".prod_thumb_list_wrap .swiper-slide IMG",[f.MOK]:".prod_thumb_list .swiper-slide IMG"},yt={[w.PBOOK]:function(){const e=bt[M()],t=[..._t,e].filter(Boolean).join(" "),n=document.querySelector(t);if(n==null)return null;const r=n.src;return r==null||r===""?null:r},[w.EBOOK]:function(){const e=gt[M()],t=[...vt,e].filter(Boolean).join(" "),n=document.querySelector(t);if(n==null)return null;const r=n.src;return r==null||r===""?null:r},[w.HOTTRACKS]:function(){const e=wt[M()],t=document.querySelector(e);if(t==null)return null;const n=t.src;return n==null||n===""?null:n}};function Ot(e,t){var n;return typeof(o=(n=e.querySelector(t))==null?void 0:n.textContent)=="number"?""+o:se(o)&&o!=null&&o.length?o.replace(/[\s\t\r\n,:원정가]+/g,""):null;var o}function fe(e){const{wrapper:t,normal:n,discount:r}=e;let o;if(m("[parseAllPriceValueBySlt] options - ",e),se(t)){const l=[...e.top??[],t].filter(Boolean).join(" ");o=document.querySelector(l),m("[parseAllPriceValueBySlt] wrap - ",o,l)}else t instanceof Element&&(o=t);if(o==null)return{normal:null,discount:null};const s=Ot.bind(null,o),[i,a]=[n,r].map(s);return{normal:i,discount:a}}const Et=[".prod_detail_view_wrap .prod_price_wrap"],It={[f.MOK]:{wrapper:".prod_price_box .price_dl",normal:".ori",discount:"P > .price"},[f.INK]:{wrapper:".eb_prod_price_box .price_box",normal:"I",discount:"P > STRONG"}},Ct={[f.MOK]:{wrapper:".prod_detail_header .product_info_area .price_wrap",normal:".real_price > .txt_value",discount:".sale_price > .txt_value"},[f.INK]:{wrapper:".prod_detail_head .prod_view_info_cont .price_line",normal:".price_origin",discount:".final_price"}},At={wrapper:".prod_detail_view_wrap .prod_price_wrap .prod_price",normal:".sale_price > .val",discount:".price > .val"},Tt={[w.PBOOK]:function(){return fe({...At})},[w.EBOOK]:function(){const e=It[M()],t=(n=>{const r=he(),o=[...Et,n].filter(Boolean).join(" "),s=Array.from(document.querySelectorAll(o)).find(i=>{var a,l;return(l=(a=i.querySelector(r?"DT":"SPAN"))==null?void 0:a.textContent)==null?void 0:l.includes("소장")});return s==null?null:s.querySelector(r?"DD":"DIV")})(e.wrapper);return t==null?null:fe({...e,wrapper:t})},[w.HOTTRACKS]:function(){return fe({...Ct[M()]})}},Lt=[c.PRODUCT_CODE,c.PRODUCT_NAME,c.PRICE,c.DC_PRICE,c.SOLDOUT,c.IMAGEURL,c.SECOND_IMAGEURL,c.THIRD_IMAGEURL,c.FOURTH_IMAGEURL,c.TOP_CATEGORY,c.FIRST_SUB_CATEGORY,c.SECOND_SUB_CATEGORY,c.THIRD_SUB_CATEGORY];function Pt(e){try{[Ye,We].forEach(n=>{const r=`mobon${n.charAt(0).toUpperCase()}${n.slice(1)}`;((o,s)=>{for(const i of o){const a=document.querySelector(i);if(a!=null)return a.classList.add(s),a}})(mt[n],r)})}catch(n){console.warn("[MOBON.parseProductData]:",n)}const t=He(Lt,e).at(0);return(n=>{var r;const o=(r=(()=>{const s=Be();if(s==null)return null;const i=Tt[s];return i==null?null:{service:s,data:i()}})())==null?void 0:r.data;o!=null&&[[c.PRICE,o.normal],[c.DC_PRICE,o.discount]].forEach(([s,i])=>{i!=null&&(n[s]=i,m("** [MOBON.assignPriceData]:",s,i))})})(t),(n=>{var r;const o=(r=(()=>{const s=Be();if(s==null)return null;const i=yt[s];return i==null?null:{service:s,data:i()}})())==null?void 0:r.data;o!=null&&(m("** [MOBON.assignImageURL]:",o),n[c.IMAGEURL]=o)})(t),t}c.PRODUCT_CODE,c.PRODUCT_NAME,c.PRICE,c.QUANTITY;const Rt=[c.PRODUCT_CODE,c.PRODUCT_NAME,c.PRICE,c.QUANTITY];function St(e){var t;const n=He(Rt,e),{price:r,count:o}=function(i){let a=0;return{price:i.map(({price:l,qty:d=1})=>{if(l!=null)return a+=d,+l*d}).filter(l=>!!l).reduce((l,d)=>l+d,0),count:a}}(n),s=function(i,a="ordrId"){return i==null&&(i=window.location.href),new URL(i).searchParams.get(a)??""}();return{product:n,totalPrice:((t=e.ecommerce)==null?void 0:t.value)??r,totalQty:o,ordCode:s}}const kt=function(e){if(e==null)return;const{event:t,ecommerce:n}=e;m("--",this.name,"- order:",t,"/",n,"-",e);const r=g(window,E);let o,s;if(t==="purchase"&&(o="conversion",s=St),o==null||s==null)return;const i=s(e);Object.assign(r,{[o]:i}),m(`-- mobon.${o}:`,g(window,`${E}.${o}`))},Nt=function(e){if(e==null)return;const{event_name:t,item_list_id:n}=e,r=g(window,E);let o,s;if(t==="view_item"&&n==="product_detail"&&(o="collect",s=Pt),o==null||s==null)return;const i=s(e);Object.assign(r,{[o]:i}),m(`-- mobon.${o}:`,g(window,`${E}.${o}`))},Dt={name:[O.MOBON,"mobion"],url:["https://cdn.megadata.co.kr/dist/prod/v2/mtm.js","?adverId=hottracks","&device="+(he()?"M":"W")].join(""),globals:E,props:{autoload:!1,compatible:["ga4"]},prototype:{pageView:function(e){Nt.call(this,e),this.load()},order:function(e){kt.call(this,e),this.load()}},prehandle(){const e=window[E]??{};A(window,E,e),Object.assign(this.globals,{global:e,[E]:e}),setTimeout(ft)}},me="_nasa",Ut=[ht,{name:O.NAVER,url:"https://wcs.naver.net/wcslog.js",globals:["wcs_add","wcs","wcs_do",me],props:{API_KEY:"s_453f4415ebcb"},prehandle(){g(window,me)==null&&A(window,me,{})},posthandle({wcs_add:e,wcs:t,wcs_do:n,_nasa:r}){var o;e.wa=(o=this.props)==null?void 0:o.API_KEY,t.inflow("kyobobook.co.kr"),n(r||{})}},dt,Dt,ut],jt=function(e,t){var n,r;const o=(n=this.props)==null?void 0:n.protoAlias;if(o==null)return;const s=(r=o.find(i=>i.name===e))==null?void 0:r.alias;s!=null&&s.forEach(i=>{this[i]=t})};var Z,J,T,x;class Mt extends De{constructor(t,n,r={}){super(r),v(this,Z,void 0),v(this,J,void 0),v(this,T,void 0),v(this,x,void 0),_(this,T,null),this.loadPromise=null,_(this,Z,t),_(this,J,n),_(this,x,{instance:this}),this.once(S.INITIALIZED,i=>{this.result=i.data});const o=n.prototype;o!=null&&Object.keys(o).forEach(i=>{const a=o[i];this[i]=a,jt.call(this,i,a)});const s=n.prehandle;if(s!=null)try{s.call(this)}catch(i){console.warn(i)}}get name(){return p(this,Z)}get loaded(){return p(this,T)!=null}get pending(){return this.loadPromise!=null}get data(){return p(this,J)}get props(){return this.data.props}get result(){return p(this,T)}set result(t){this.result==null&&(this.loadPromise=null,_(this,T,t),p(this,T).instance=this,Object.assign(p(this,x),t.globals))}get element(){var t;return(t=this.result)==null?void 0:t.target}get globals(){return p(this,x)}match(t){const n=this.data.name;return Array.isArray(n)?n.includes(t):this.name===t}load(){if(this.loaded)return Promise.resolve(this.result);if(this.pending)return this.loadPromise;const t=this.data,n={name:this.name,url:t.url,globals:t.globals};return this.loadPromise=async function(r){const{name:o,url:s,attrs:i,async:a,defer:l,globals:d}=r,b=r.type??((te=s).indexOf("?")&&(te=te.split("?")[0]),/\.css$/.test(te)?j.CSS:j.JS),we=b===j.JS,ee=r.parentTag??(we?"body":"head");var te;let h;if(we?(h=document.createElement("script"),h.src=s,h.defer=l??!0,h.async=a??!0):(h=document.createElement("link"),h.rel="stylesheet",h.href=s),h.type="text/"+(we?"javascript":"css"),i!=null)for(const I in i)h.setAttribute(I,i[I]);const Ve=await new Promise((I,_e)=>{h.addEventListener("error",L=>_e(L));const B=function(L){const{name:ne,url:re,type:oe}=L,K=oe===j.JS,y=document.querySelectorAll(K?de.SCRIPT:de.LINK);for(let C=0;C<y.length;C+=1){const U=y[C];if(ne!=null&&U.getAttribute("type")===ne)return U;const G=K?"src":"href",ie=U.getAttribute(G);if(ie&&ie.includes(re))return U}return null}({type:b,url:s,name:o});if(B!=null)return console.warn(`[kbbStats.importScriptV2] duplicate import url: ${s}`),I({target:B});h.addEventListener("load",L=>{I({event:L,target:h})});try{document[ee].appendChild(h)}catch{ee==="body"?document[ee].appendChild(h):console.error(`${o} append to ${ee} failed. ${s}`)}});return d==null?Promise.resolve(Ve):await function(I,_e){let B=0;return new Promise((L,ne)=>{const re=setInterval(()=>{const oe=I.map(y=>{const C=window[y];return C==null?null:{key:y,value:C}});if(oe.every(y=>y!=null)){clearInterval(re);const y=function(U){const G={};return U.forEach(({key:ie,value:Fe},Yt)=>{Yt||(G.global=Fe),G[ie]=Fe}),G}(oe),C=Object.assign({},_e,{globals:y});return L(C)}if(B+=1,B<5)return;clearInterval(re);const K=new Error(`Failed to load globals: ${I.join(", ")}`);return console.error(K),ne(K)},100)})}(R(d),Ve)}(n).then(r=>{this.emit(S.INITIALIZED,{data:r});const o=t.posthandle;if(o!=null)try{o.call(this,this.globals)}catch(s){console.warn(s)}}).then(()=>this.result),this.loadPromise}}Z=new WeakMap,J=new WeakMap,T=new WeakMap,x=new WeakMap;class xt extends Mt{constructor(t,n,r={}){super(t,n,r)}}const Bt=function(e,t,n){var r,o,s;const i=this.get(e);if(i==null)return;const a=n==null?void 0:n.raw,l=(r=n==null?void 0:n.vendors)==null?void 0:r[e];if(a!=null&&l!=null&&typeof l=="function"){const d=Object.assign({instance:i},i.globals);return R(a).forEach(b=>{l.call(i,d,b)})}(s=(o=i.props)==null?void 0:o.compatible)!=null&&s.includes("ga4")&&Object.hasOwnProperty.call(i,t)&&(m(`%c** ${i.name} ** GA4 Event Compatible Interface: ${t}`,"color: yellow;"),i[t](n))},Kt=function(e,t=[]){const n=`* [kbb.stats] ${e}`,r=t.at(0);if(t.length&&(t.length!==1||Object.keys(r).length!==1||r.ecommerce!==null)){m(n,...t);try{st.forEach(o=>Bt.call(this,o,e,r))}catch(o){console.warn(o)}(function(o){if(o==null)return void console.warn("* [ga4.dataLayer] no required data parameter");const s=(i=>((a,l)=>{const d=new Set(["raw","vendors"]);return Object.fromEntries(Object.entries(a).filter(b=>!d.has(b[0])))})(i))(o);lt.push(s)})(r)}};function ve(e){return Array.isArray(e)?e[0]:e}const Gt=function(e){const t=ve(e);R(e).forEach(n=>{this[n]==null&&(this[n]=r=>{const o=this.getReadyStackItem(t);if(o!=null)return o.loaded?this.ready(t,r):void o.list.push(r)})})},$t=function(e){this.initialized||(e.map(async t=>{const n=t.name,r=ve(n),o=`loaded-${r}`;return this.readyEventStack.push({name:r,loaded:!1,list:[]}),Gt.call(this,n),this.once(`loaded-${r}`,({instance:s})=>{const i=this.getReadyStackItem(r);i!=null&&(i.list.forEach(a=>this.ready(r,a)),i.loaded=!0,m([`%c* [kbb.stats] ${ze(o).toUpperCase()} -`,"props:",Object.keys(s.globals)].join(" "),"color: royalblue;"))}),this.register(t).then(s=>{const i=s.instance;if(i.loaded)return this.emit(o,s);i.once(S.INITIALIZED,()=>{this.emit(o,s)})})}),this.emit(S.INITIALIZED))};var Q,X;class Ht extends ot{constructor(){super(),v(this,Q,void 0),v(this,X,void 0),this.readyEventStack=[],_(this,Q,Kt.bind(this)),_(this,X,$t.bind(this)),at.forEach(t=>{switch(t){case N.INIT:case N.GET_DATA:case N.SET_DATA:return}this[t]==null&&(this[t]=async function(...n){return this.ready().then(()=>p(this,Q).call(this,t,n))})})}get name(){return"kbb.stats"}get version(){return"1.0.6"}init(t){if(t!=null&&(Array.isArray(t)||(t=[t]),t.length))return p(this,X).call(this,t)}getReadyStackItem(t){return this.readyEventStack.find(n=>n.name===t)}get(t){return this.list.find(n=>n.match(t))}register(t){var n;if(t==null)return Promise.reject(new Error("required data"));const r=ve(t.name);if(r==null)return Promise.reject(new Error("required data.name"));let o=this.get(r);return o!=null?o.loaded?Promise.resolve(o.result):o.loadPromise:(o=new xt(r,t),this.list.push(o),((n=t.props)==null?void 0:n.autoload)===!1?Promise.resolve({instance:o,globals:{}}):o.load())}async ready(t,n){if(t==null)return new Promise(a=>{if(this.initialized)return a(this);this.once("initialized",()=>a(this))});const r=await this.load(t),{globals:o,...s}=r,i=Object.assign({},s,o);return n!=null&&n.call(r.instance,i),await Promise.resolve(i)}async load(t){await this.ready();const n=this.get(t);return n==null?Promise.reject(new Error(`not found instance: ${t}`)):n.load()}}Q=new WeakMap,X=new WeakMap;const qt=["kbb.stats"],ge=function(){const e=new Ht;qt.forEach(r=>{A(window,r,e),m(`* ${r} loaded: v${g(window,r+".version")}`)});const t=Ut,n=()=>e.init(t);return document.readyState==="loading"?document.addEventListener("DOMContentLoaded",n):n(),e}();(async()=>new Promise(e=>{if(ge.initialized)return e();ge.once("initialized",()=>e())}).then(()=>{setTimeout(()=>ge.load("mobon"),1500)}))()});
